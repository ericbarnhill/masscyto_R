source('masscyto_explore_medians.R')
m <- explore_medians(mass_cyto_tall)
par(mfrow=c(3,2))
par(mar=c(2,2,2,2))
for (n in levels(mass_cyto_tall$CellType)) {
boxplot(value ~ Experiment, subset(mass_cyto_tall, MeasurementType == "Median" & CellType == n))
title(n)
xlab("Experiment")
}
source('masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
gamma_model <- function(par){
samples <- rgamma(10000, shape=par[1], rate=par[2])
mn <- mean(samples)
mdn <- median(samples)
qtls <- quantile(samples, c(0.05, 0.95))
sum_stats <- c(mn, mdn, qtls[1], qtls[2])
return(sum_stats)
}
call_abc_model <- function() {
m2 <- ABC_mcmc(method="Marjoram", model=gamma_model,                             prior=list(c("unif",1e-3,10),c("unif",1e-3,5)),
summary_stat_target=group_sum_stats, n_rec = N_REC,
verbose=TRUE)
}
est_gamma_mle <- function(group_sum_stats) {
ofn <- function(x,q) {
sum(abs(c(
q[c(3,1,4)]-qgamma(c(0.05,0.5,0.95),x[1],x[2]),
q[2] - median(rgamma(10000, x[1], x[2]))
)^2))
}
dist <- optim(c(1,1),fn=ofn,q=group_sum_stats)
}
source("masscyto_predict_summary_stats.R")
load("dist_models.Rdata")
results_list <- collect_dist_results(mass_cyto_tall, dist_models)
plot_dist_results(results_list$dist_results)
(make_error_table(results_list$error_results))
cat(readLines('masscyto_model_celltype_dgamma_2.txt'), sep = '\n')
load(file = "final_models.RData")
plot(models[[2]][[3]]$sim)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(root.dir = "/home/ericbarnhill/Documents/code/R/2017-12-15-masscyto")
require(EasyABC)
require(gdata)
require(tidyr)
require(rlist)
require(ggplot2)
require(HDInterval)
require(reshape2)
require(rjags)
models[[2]][[1]]$Gelman
source('masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
str(quantiles_tall)
meas_vec
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
str(quantiles_tall)
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
str(quantiles_tall)
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
str(quantiles_tall)
summary(quantiles_tall)
head(quantiles_tall)
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
str(quantiles)
str(quantiles)
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
str(quantiles)
str(quantiles)
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
meas_vec
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
str(quantiles_tall)
quantiles_tall$value <-as.numeric(quantiles_tall$value)
str(quantiles_tall)
quantiles_plot <- ggplot(quantiles_tall) +
geom_line(aes(y=as.numeric(value), group=value_type, col=value_type)) +
facet_wrap(~ CellType) +
labs(title="Reported Quantiles for Experimental Conditions",
x="Condition", y="Value")
print(quantiles_plot)
ggplot(quantiles_tall) +
geom_line(aes(y=as.numeric(value), group=value_type, col=value_type)) +
labs(title="Reported Quantiles for Experimental Conditions",
x="Condition", y="Value")
str(quantiles)
ggplot(quantiles_tall) +
geom_line(aes(x=seq(1,9,1), y=value, group=value_type, col=value_type)) +
labs(title="Reported Quantiles for Experimental Conditions",
x="Condition", y="Value")
ggplot(quantiles_tall) +
geom_line(aes(x=seq(1,54,1), y=value, group=value_type, col=value_type)) +
labs(title="Reported Quantiles for Experimental Conditions",
x="Condition", y="Value")
dim(quantiles_tall)
ggplot(quantiles_tall) +
geom_line(aes(x=seq(1,216,1), y=value, group=value_type, col=value_type)) +
labs(title="Reported Quantiles for Experimental Conditions",
x="Condition", y="Value")
ggplot(quantiles_tall) +
geom_line(aes(x=seq(1,216,1), y=value, group=value_type, col=value_type)) +
labs(title="Reported Quantiles for Experimental Conditions",
x="Condition", y="Value") +
facet_wrap( ~ CellType)
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
colnames(quantiles) <- c(measurements, "CellType", "index")
qt <- quantiles_table(mass_cyto_tall)
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
quantiles <- as.data.frame(quantiles)
str(quantiels)
str(quantiles)
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
str(quantiles_tall)
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
quantiles_tall <- gather(quantiles, "value_type", "value", factor_key = T, -5:6)
quantiles_tall <- gather(quantiles, "value_type", "value", factor_key = T, -c(5,6))
quantiles_tall <- gather(quantiles, "value_type", "value", factor_key = T, -CellType, -index)
qt <- quantiles_table(mass_cyto_tall)
quantiles_tall <- gather(quantiles, "value_type", "value", factor_key = T, -c(5,6))
qt <- quantiles_table(mass_cyto_tall)
quantiles_tall <- gather(quantiles, "value_type", "value", factor_key = T, -CellType)
qt <- quantiles_table(mass_cyto_tall)
quantiles_tall <- gather(quantiles, "value_type", "value", factor_key = T, -5:6)
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
quantiles_tall <- gather(quantiles, "value_type", "value", factor_key = T, -CellType)
quantiles_tall <- gather(quantiles, "value_type", "value", factor_key = T, -c("CellType")
)
quantiles_tall <- gather(quantiles, "value_type", "value", factor_key = T, -c("CellType", "index"))
quantiles_tall <- gather(quantiles, "value_type", "value", factor_key = T, -5
)
quantiles_tall <- gather(quantiles, "value_type", "value", factor_key = T, -5)
quantiles_tall <- gather(quantiles, "value_type", "value", factor_key = T, -6)
quantiles_tall <- gather(quantiles, "value_type", "value", factor_key = T, -5:6)
quantiles_tall <- gather(quantiles, "value_type", "value", factor_key = T, -(5:6)
)
str(quantiles_tall)
summary(quantiles_tall)
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
qt <- quantiles_table(mass_cyto_tall)
plot(models[[2]][[3]]$sim)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(root.dir = "/home/ericbarnhill/Documents/code/R/2017-12-15-masscyto")
require(EasyABC)
require(gdata)
require(tidyr)
require(rlist)
require(ggplot2)
require(HDInterval)
require(reshape2)
require(rjags)
require(RColorBrewer)
source('masscyto_clean_gather_data.R')
MASSCYTO_DIR = "/home/ericbarnhill/Documents/code/R/2017-12-15-masscyto/"
mass_cyto_xls_path <- file.path(MASSCYTO_DIR, "angela.xlsx")
mass_cyto <- read.xls(xls=mass_cyto_xls_path, header=FALSE, skip=3, nrows=30)[,-(5:10)]
mass_cyto_tall <- clean_gather_data(mass_cyto)
str(mass_cyto_tall)
source('masscyto_explore_medians.R')
m <- explore_medians(mass_cyto_tall)
par(mfrow=c(3,2))
par(mar=c(2,2,2,2))
for (n in levels(mass_cyto_tall$CellType)) {
boxplot(value ~ Experiment, subset(mass_cyto_tall, MeasurementType == "Median" & CellType == n))
title(n)
xlab("Experiment")
}
source('masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
gamma_model <- function(par){
samples <- rgamma(10000, shape=par[1], rate=par[2])
mn <- mean(samples)
mdn <- median(samples)
qtls <- quantile(samples, c(0.05, 0.95))
sum_stats <- c(mn, mdn, qtls[1], qtls[2])
return(sum_stats)
}
call_abc_model <- function() {
m2 <- ABC_mcmc(method="Marjoram", model=gamma_model,                             prior=list(c("unif",1e-3,10),c("unif",1e-3,5)),
summary_stat_target=group_sum_stats, n_rec = N_REC,
verbose=TRUE)
}
est_gamma_mle <- function(group_sum_stats) {
ofn <- function(x,q) {
sum(abs(c(
q[c(3,1,4)]-qgamma(c(0.05,0.5,0.95),x[1],x[2]),
q[2] - median(rgamma(10000, x[1], x[2]))
)^2))
}
dist <- optim(c(1,1),fn=ofn,q=group_sum_stats)
}
source("masscyto_predict_summary_stats.R")
load("dist_models.Rdata")
results_list <- collect_dist_results(mass_cyto_tall, dist_models)
plot_dist_results(results_list$dist_results)
(make_error_table(results_list$error_results))
cat(readLines('masscyto_model_celltype_dgamma_2.txt'), sep = '\n')
load(file = "final_models.RData")
plot(models[[2]][[3]]$sim)
models[[2]][[1]]$Gelman
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(root.dir = "/home/ericbarnhill/Documents/code/R/2017-12-15-masscyto")
require(EasyABC)
require(gdata)
require(tidyr)
require(rlist)
require(ggplot2)
require(HDInterval)
require(reshape2)
require(rjags)
require(RColorBrewer)
source('masscyto_clean_gather_data.R')
MASSCYTO_DIR = "/home/ericbarnhill/Documents/code/R/2017-12-15-masscyto/"
mass_cyto_xls_path <- file.path(MASSCYTO_DIR, "angela.xlsx")
mass_cyto <- read.xls(xls=mass_cyto_xls_path, header=FALSE, skip=3, nrows=30)[,-(5:10)]
mass_cyto_tall <- clean_gather_data(mass_cyto)
str(mass_cyto_tall)
source('masscyto_explore_medians.R')
m <- explore_medians(mass_cyto_tall)
par(mfrow=c(3,2))
par(mar=c(2,2,2,2))
for (n in levels(mass_cyto_tall$CellType)) {
boxplot(value ~ Experiment, subset(mass_cyto_tall, MeasurementType == "Median" & CellType == n))
title(n)
xlab("Experiment")
}
source('masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
gamma_model <- function(par){
samples <- rgamma(10000, shape=par[1], rate=par[2])
mn <- mean(samples)
mdn <- median(samples)
qtls <- quantile(samples, c(0.05, 0.95))
sum_stats <- c(mn, mdn, qtls[1], qtls[2])
return(sum_stats)
}
call_abc_model <- function() {
m2 <- ABC_mcmc(method="Marjoram", model=gamma_model,                             prior=list(c("unif",1e-3,10),c("unif",1e-3,5)),
summary_stat_target=group_sum_stats, n_rec = N_REC,
verbose=TRUE)
}
est_gamma_mle <- function(group_sum_stats) {
ofn <- function(x,q) {
sum(abs(c(
q[c(3,1,4)]-qgamma(c(0.05,0.5,0.95),x[1],x[2]),
q[2] - median(rgamma(10000, x[1], x[2]))
)^2))
}
dist <- optim(c(1,1),fn=ofn,q=group_sum_stats)
}
source("masscyto_predict_summary_stats.R")
load("dist_models.Rdata")
results_list <- collect_dist_results(mass_cyto_tall, dist_models)
plot_dist_results(results_list$dist_results)
(make_error_table(results_list$error_results))
cat(readLines('masscyto_model_celltype_dgamma_2.txt'), sep = '\n')
load(file = "final_models.RData")
plot(models[[2]][[3]]$sim)
models[[2]][[1]]$Gelman
source("masscyto_contrasts.R")
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_contrasts.R')
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_contrasts.R')
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_contrasts.R')
str(contrast_values)
contrast_values <- plot_contrast_agent_slopes(models, mass_cyto_tall)
contrast_values
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_contrasts.R')
contrast_values <- plot_contrast_agent_slopes(models, mass_cyto_tall)
str(contrast_values)
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_contrasts.R')
contrast_values <- plot_contrast_agent_slopes(models, mass_cyto_tall)
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_contrasts.R')
contrast_values <- plot_contrast_agent_slopes(models, mass_cyto_tall)
str(contrast_values)
spread(contrast_values, "x", cont_indices")
))
)
spread(contrast_values, "x", cont_indices)
spread(contrast_values, cont_indices, "x")
spread(contrast_values, cont_indices, cell_type_indices)
spread(contrast_values, cell_type_indices, cont_indices)
spread(contrast_values, cont_indices, cell_type_indices)
spread(contrast_values, cont_indices)
str(contrast_values)
spread(contrast_values, cont_indices, -c(2,4))
?spread
cont_val <- contrast_values[,-c(4,6)]
str(cont_val)
cont_val <- contrast_values[,-c(3,5)]
str(cont_val)
spread(cont_val, cont_indices, cell_type_indices)
spread(cont_val, cont_indices, mean)
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_contrasts.R')
contrasts_data_table(contrast_values)
(contrasts_data_table(contrast_values))
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_contrasts.R')
(contrasts_data_table(contrast_values))
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_contrasts.R')
(contrasts_data_table(contrast_values))
source('~/.active-rstudio-document', echo=TRUE)
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_contrasts.R')
contrasts_data_table(contrast_values)
source('~/.active-rstudio-document', echo=TRUE)
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_contrasts.R')
plot_contrast_agent_slopes(contrast_values)
contrast_values <- plot_contrast_agent_slopes(models, mass_cyto_tall)
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_contrasts.R')
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_contrasts.R')
contrast_values <- plot_contrast_agent_slopes(models, mass_cyto_tall)
contrast_values <- contrast_agent_slopes(models, mass_cyto_tall)
warnings()
contrast_values <- contrast_agent_slopes(models, mass_cyto_tall)
warnings()
contrast_values <- contrast_agent_slopes(models, mass_cyto_tall)
debugSource('~/Documents/code/R/2017-12-15-masscyto/masscyto_contrasts.R')
contrast_values <- contrast_agent_slopes(models, mass_cyto_tall)
warnings()
rm(list=ls())
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(root.dir = "/home/ericbarnhill/Documents/code/R/2017-12-15-masscyto")
require(EasyABC)
require(gdata)
require(tidyr)
require(rlist)
require(ggplot2)
require(HDInterval)
require(reshape2)
require(rjags)
require(RColorBrewer)
source('masscyto_clean_gather_data.R')
MASSCYTO_DIR = "/home/ericbarnhill/Documents/code/R/2017-12-15-masscyto/"
mass_cyto_xls_path <- file.path(MASSCYTO_DIR, "angela.xlsx")
mass_cyto <- read.xls(xls=mass_cyto_xls_path, header=FALSE, skip=3, nrows=30)[,-(5:10)]
mass_cyto_tall <- clean_gather_data(mass_cyto)
str(mass_cyto_tall)
source('masscyto_explore_medians.R')
m <- explore_medians(mass_cyto_tall)
par(mfrow=c(3,2))
par(mar=c(2,2,2,2))
for (n in levels(mass_cyto_tall$CellType)) {
boxplot(value ~ Experiment, subset(mass_cyto_tall, MeasurementType == "Median" & CellType == n))
title(n)
xlab("Experiment")
}
source('masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
gamma_model <- function(par){
samples <- rgamma(10000, shape=par[1], rate=par[2])
mn <- mean(samples)
mdn <- median(samples)
qtls <- quantile(samples, c(0.05, 0.95))
sum_stats <- c(mn, mdn, qtls[1], qtls[2])
return(sum_stats)
}
call_abc_model <- function() {
m2 <- ABC_mcmc(method="Marjoram", model=gamma_model,                             prior=list(c("unif",1e-3,10),c("unif",1e-3,5)),
summary_stat_target=group_sum_stats, n_rec = N_REC,
verbose=TRUE)
}
est_gamma_mle <- function(group_sum_stats) {
ofn <- function(x,q) {
sum(abs(c(
q[c(3,1,4)]-qgamma(c(0.05,0.5,0.95),x[1],x[2]),
q[2] - median(rgamma(10000, x[1], x[2]))
)^2))
}
dist <- optim(c(1,1),fn=ofn,q=group_sum_stats)
}
source("masscyto_predict_summary_stats.R")
load("dist_models.Rdata")
results_list <- collect_dist_results(mass_cyto_tall, dist_models)
plot_dist_results(results_list$dist_results)
(make_error_table(results_list$error_results))
cat(readLines('masscyto_model_celltype_dgamma_2.txt'), sep = '\n')
load(file = "final_models.RData")
plot(models[[2]][[3]]$sim)
models[[2]][[1]]$Gelman
source("masscyto_contrasts.R")
contrast_values <- contrast_agent_slopes(models, mass_cyto_tall)
contrasts_data_table(contrast_values)
plot_contrast_agent_slopes(models, mass_cyto_tall)
qt <- quantiles_table(mass_cyto_tall)
qt <- quantiles_table(mass_cyto_tall)
qt <- quantiles_table(mass_cyto_tall)
colnames(quantiles) <- c(measurements, "CellType", "index")
rownames(quantiles) <- NULL
quantiles
quantiles_tall <- gather(quantiles, "value_type", "value", factor_key = T, -(5:6))
str(quantiles)
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
source('~/Documents/code/R/2017-12-15-masscyto/masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(root.dir = "/home/ericbarnhill/Documents/code/R/2017-12-15-masscyto")
require(EasyABC)
require(gdata)
require(tidyr)
require(rlist)
require(ggplot2)
require(HDInterval)
require(reshape2)
require(rjags)
require(RColorBrewer)
source('masscyto_clean_gather_data.R')
MASSCYTO_DIR = "/home/ericbarnhill/Documents/code/R/2017-12-15-masscyto/"
mass_cyto_xls_path <- file.path(MASSCYTO_DIR, "angela.xlsx")
mass_cyto <- read.xls(xls=mass_cyto_xls_path, header=FALSE, skip=3, nrows=30)[,-(5:10)]
mass_cyto_tall <- clean_gather_data(mass_cyto)
str(mass_cyto_tall)
source('masscyto_explore_medians.R')
m <- explore_medians(mass_cyto_tall)
par(mfrow=c(3,2))
par(mar=c(2,2,2,2))
for (n in levels(mass_cyto_tall$CellType)) {
boxplot(value ~ Experiment, subset(mass_cyto_tall, MeasurementType == "Median" & CellType == n))
title(n)
xlab("Experiment")
}
source('masscyto_quantiles_table.R')
qt <- quantiles_table(mass_cyto_tall)
gamma_model <- function(par){
samples <- rgamma(10000, shape=par[1], rate=par[2])
mn <- mean(samples)
mdn <- median(samples)
qtls <- quantile(samples, c(0.05, 0.95))
sum_stats <- c(mn, mdn, qtls[1], qtls[2])
return(sum_stats)
}
call_abc_model <- function() {
m2 <- ABC_mcmc(method="Marjoram", model=gamma_model,                             prior=list(c("unif",1e-3,10),c("unif",1e-3,5)),
summary_stat_target=group_sum_stats, n_rec = N_REC,
verbose=TRUE)
}
est_gamma_mle <- function(group_sum_stats) {
ofn <- function(x,q) {
sum(abs(c(
q[c(3,1,4)]-qgamma(c(0.05,0.5,0.95),x[1],x[2]),
q[2] - median(rgamma(10000, x[1], x[2]))
)^2))
}
dist <- optim(c(1,1),fn=ofn,q=group_sum_stats)
}
source("masscyto_predict_summary_stats.R")
load("dist_models.Rdata")
results_list <- collect_dist_results(mass_cyto_tall, dist_models)
plot_dist_results(results_list$dist_results)
(make_error_table(results_list$error_results))
cat(readLines('masscyto_model_celltype_dgamma_2.txt'), sep = '\n')
load(file = "final_models.RData")
plot(models[[2]][[3]]$sim)
models[[2]][[1]]$Gelman
source("masscyto_contrasts.R")
contrast_values <- contrast_agent_slopes(models, mass_cyto_tall)
contrasts_data_table(contrast_values)
plot_contrast_agent_slopes(models)
cat(readLines('masscyto_model_celltype_dgamma_2.txt'), sep = '\n')
quit()
